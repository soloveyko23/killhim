(()=>{"use strict";let e=!1;setTimeout((()=>{if(e){let e=new Event("windowScroll");window.addEventListener("scroll",(function(t){document.dispatchEvent(e)}))}}),0);const t={"type-one":{logo:"./img/type-one/logo.png",die:"./img/type-one/die.jpg",fright:"./img/type-one/fright.jpg",default:"./img/type-one/default.jpg"},"type-two":{logo:"./img/type-two/logo.png",die:"./img/type-two/die.svg",fright:"./img/type-two/fright.jpg",default:"./img/type-two/default.svg"},"type-three":{logo:"./img/type-three/logo.png",die:"./img/type-three/die.svg",fright:"./img/type-three/fright.svg",default:"./img/type-three/default.svg"}},o=10,s=700,i=500,n="./img/sounds/shot.mp3",c=1e3,r=500;let a=Object.keys(t)[Math.floor(Math.random()*Object.keys(t).length)],u={shotsRemaining:parseInt(localStorage.getItem("shotsRemaining"),10)||o,lastResetDate:localStorage.getItem("lastResetDate")||(new Date).toDateString(),isClicked:!1,soundMuted:!0,scareSoundPlaying:!1,scareAudio:null,shotAudio:new Audio(n),lastScareSoundTime:0,clickProcessing:!1};const d={soundButton:document.querySelector(".sound-button"),picture:document.querySelector(".picture"),pictureImage:document.querySelector(".picture__image img"),blood:document.querySelector(".picture__blood"),tokensInfo:document.querySelector(".tokens-info b"),cursor:document.querySelector(".picture__cursor"),headerLogo:document.querySelector(".header-app__logo img"),headerTradeImage:document.querySelector(".header-app__trade-image img")},l=(e,o=!1)=>{o?b(t[e].default):w(t[e].default),d.headerLogo.src=t[e].logo,d.headerTradeImage.src=t[e].logo},g=()=>{localStorage.setItem("shotsRemaining",u.shotsRemaining),localStorage.setItem("lastResetDate",u.lastResetDate)},m=()=>{const e=u.soundMuted?"charm_sound-mute.svg":"charm_sound-down.svg";d.soundButton.querySelector("img").src=`./img/${e}`},p=()=>{u.scareAudio&&(u.scareAudio.pause(),u.scareAudio.currentTime=0,u.scareSoundPlaying=!1)},y=()=>{d.tokensInfo.textContent=`${u.shotsRemaining} kill${1!==u.shotsRemaining?"s":""}/day`},h=()=>{setTimeout((()=>{d.blood.style.opacity="0",d.cursor.style.opacity="0"}),100)},f=()=>{d.pictureImage.classList.remove("shake")},v=()=>{u.soundMuted=!u.soundMuted,m()},S=()=>{u.isClicked||(d.pictureImage.src=t[a].fright,d.pictureImage.classList.add("shake"),(()=>{const e=Date.now();e-u.lastScareSoundTime<c||_()||(u.lastScareSoundTime=e,u.soundMuted||u.scareSoundPlaying||(u.scareAudio=new Audio("./img/sounds/ispugannoe-dyihanie.mp3"),u.scareSoundPlaying=!0,u.scareAudio.play().catch((e=>console.error("Sound playback failed:",e))),u.scareAudio.onended=()=>{u.scareSoundPlaying=!1}))})())},k=()=>{d.cursor.style.opacity="0",d.pictureImage.src=t[a].default,p(),h(),f()},w=e=>{u.clickProcessing=!0,I((()=>{E(),L(e),setTimeout((()=>{u.clickProcessing=!1}),i)}))},I=e=>{d.pictureImage.style.opacity="0",setTimeout(e,i)},L=e=>{d.pictureImage.src=e,setTimeout((()=>{d.pictureImage.style.opacity="1"}),50)},E=()=>{p(),h(),f()},b=e=>{d.pictureImage.style.transition="none",d.pictureImage.src=e,d.pictureImage.style.opacity="1",setTimeout((()=>{d.pictureImage.style.transition=`opacity ${i}ms ease`}),50)},R=()=>{d.picture.addEventListener("click",T),d.picture.addEventListener("touchstart",T)},T=e=>{if(!u.clickProcessing){if(d.picture.removeEventListener("click",T),d.picture.removeEventListener("touchstart",T),u.clickProcessing=!0,u.shotsRemaining<=0)return alert("You have no shots remaining today!"),R(),void(u.clickProcessing=!1);u.shotsRemaining-=1,y(),g(),u.soundMuted||u.shotAudio.play().catch((e=>console.error("Shot sound playback failed:",e))),f(),(e=>{const t=d.picture.getBoundingClientRect(),o=(e.clientX||e.touches[0].clientX)-t.left,s=(e.clientY||e.touches[0].clientY)-t.top;d.blood.style.left=o-d.blood.offsetWidth/2+"px",d.blood.style.top=s-d.blood.offsetHeight/2+"px",d.blood.style.opacity="1",_()||(d.cursor.style.left=o-d.cursor.offsetWidth/2+"px",d.cursor.style.top=s-d.cursor.offsetHeight/2+"px",d.cursor.style.opacity="1")})(e),setTimeout((()=>{h();const e=(e=>{const o=Object.keys(t).filter((t=>t!==e));return o[Math.floor(Math.random()*o.length)]})(a);a=e,l(e),setTimeout((()=>{setTimeout((()=>{R(),u.clickProcessing=!1}),1e3)}),s)}),300)}},P=e=>{if(_())return;const t=d.picture.getBoundingClientRect(),o=e.clientX-t.left-d.cursor.offsetWidth/2,s=e.clientY-t.top-d.cursor.offsetHeight/2;d.cursor.style.left=`${o}px`,d.cursor.style.top=`${s}px`,d.cursor.style.opacity="1"},_=()=>window.innerWidth<=r;Object.values(t).forEach((e=>{Object.values(e).forEach((e=>{e&&((new Image).src=e)}))})),(()=>{const e=(new Date).toDateString();u.lastResetDate!==e&&(u.shotsRemaining=o,u.lastResetDate=e,g())})(),y(),m(),l(a,!0),d.soundButton.addEventListener("click",v),_()?d.picture.addEventListener("touchstart",T):(d.picture.addEventListener("mousemove",S),d.picture.addEventListener("mouseleave",k),d.picture.addEventListener("mousemove",P),d.picture.addEventListener("click",T)),d.pictureImage.style.transition=`opacity ${i}ms ease`,window.FLS=!0,document.documentElement.classList.contains("loading")||window.addEventListener("load",(function(){setTimeout((function(){document.documentElement.classList.add("loaded")}),0)}))})();
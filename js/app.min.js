(()=>{"use strict";let e=!1;setTimeout((()=>{if(e){let e=new Event("windowScroll");window.addEventListener("scroll",(function(t){document.dispatchEvent(e)}))}}),0);const t={"type-one":{logo:"./img/type-one/logo.png",die:"./img/type-one/die.jpg",fright:"./img/type-one/fright.jpg",default:"./img/type-one/default.jpg"},"type-two":{logo:"./img/type-two/logo.png",die:"./img/type-two/die.svg",fright:"./img/type-two/fright.jpg",default:"./img/type-two/default.png"},"type-three":{logo:"./img/type-three/logo.png",die:"./img/type-three/die.svg",fright:"./img/type-three/fright.svg",default:"./img/type-three/default.svg"}},o=10,s=700,i=500,r="./img/sounds/shot.mp3",c=1e3,n=300;let a=Object.keys(t)[Math.floor(Math.random()*Object.keys(t).length)],u={shotsRemaining:parseInt(localStorage.getItem("shotsRemaining"),10)||o,lastResetDate:localStorage.getItem("lastResetDate")||(new Date).toDateString(),isClicked:!1,soundMuted:!0,scareSoundPlaying:!1,scareAudio:null,shotAudio:new Audio(r),lastScareSoundTime:0,clickProcessing:!1,temporaryShakeDisabled:!1};const l={soundButton:document.querySelector(".sound-button"),picture:document.querySelector(".picture"),pictureImage:document.querySelector(".picture__image img"),blood:document.querySelector(".picture__blood"),tokensInfo:document.querySelector(".tokens-info b"),cursor:document.querySelector(".picture__cursor"),headerLogo:document.querySelector(".header-app__logo img"),headerTradeImage:document.querySelector(".header-app__trade-image img")},d=(e,o=!1)=>{o?E(t[e].default):w(t[e].default),l.headerLogo.src=t[e].logo,l.headerTradeImage.src=t[e].logo},g=()=>{localStorage.setItem("shotsRemaining",u.shotsRemaining),localStorage.setItem("lastResetDate",u.lastResetDate)},m=()=>{const e=u.soundMuted?"charm_sound-mute.svg":"charm_sound-down.svg";l.soundButton.querySelector("img").src=`./img/${e}`},p=()=>{u.scareAudio&&(u.scareAudio.pause(),u.scareAudio.currentTime=0,u.scareSoundPlaying=!1)},h=()=>{l.tokensInfo.textContent=`${u.shotsRemaining} kill${1!==u.shotsRemaining?"s":""}/day`},y=()=>{setTimeout((()=>{l.blood.style.opacity="0",l.cursor.style.opacity="0"}),100)},f=()=>{l.pictureImage.classList.remove("shake")},S=()=>{u.soundMuted=!u.soundMuted,m()},v=()=>{u.temporaryShakeDisabled||u.isClicked||(l.pictureImage.src=t[a].fright,l.pictureImage.classList.add("shake"),(()=>{const e=Date.now();e-u.lastScareSoundTime<c||P()||(u.lastScareSoundTime=e,u.soundMuted||u.scareSoundPlaying||(u.scareAudio=new Audio("./img/sounds/ispugannoe-dyihanie.mp3"),u.scareSoundPlaying=!0,u.scareAudio.play().catch((e=>console.error("Sound playback failed:",e))),u.scareAudio.onended=()=>{u.scareSoundPlaying=!1}))})())},k=()=>{l.pictureImage.src=t[a].default,p(),y(),f();const e=l.picture.getBoundingClientRect();l.cursor.style.left=e.width-l.cursor.offsetWidth+"px",l.cursor.style.top=e.height-l.cursor.offsetHeight+"px",l.cursor.style.opacity="1"},w=e=>{u.clickProcessing=!0,I((()=>{L(),b(e),setTimeout((()=>{u.clickProcessing=!1}),i)}))},I=e=>{l.pictureImage.style.opacity="0",setTimeout(e,i)},b=e=>{l.pictureImage.src=e,setTimeout((()=>{l.pictureImage.style.opacity="1"}),50)},L=()=>{p(),y(),f()},E=e=>{l.pictureImage.style.transition="none",l.pictureImage.src=e,l.pictureImage.style.opacity="1",setTimeout((()=>{l.pictureImage.style.transition=`opacity ${i}ms ease`}),50)},R=()=>{l.picture.addEventListener("click",T),l.picture.addEventListener("touchstart",T)},T=e=>{if(u.clickProcessing)return;if(l.picture.removeEventListener("click",T),l.picture.removeEventListener("touchstart",T),u.clickProcessing=!0,u.shotsRemaining<=0)return alert("You have no shots remaining today!"),R(),void(u.clickProcessing=!1);u.shotsRemaining-=1,h(),g(),u.soundMuted||u.shotAudio.play().catch((e=>console.error("Shot sound playback failed:",e))),(e=>{const t=l.picture.getBoundingClientRect(),o=(e.clientX||e.touches[0].clientX)-t.left,s=(e.clientY||e.touches[0].clientY)-t.top;l.blood.style.left=o-l.blood.offsetWidth/2+"px",l.blood.style.top=s-l.blood.offsetHeight/2+"px",l.blood.style.opacity="1",P()||(l.cursor.style.left=o-l.cursor.offsetWidth/2+"px",l.cursor.style.top=s-l.cursor.offsetHeight/2+"px",l.cursor.style.opacity="1")})(e);const o=l.picture.getBoundingClientRect(),i=(e.clientX||e.touches[0].clientX)-o.left,r=(e.clientY||e.touches[0].clientY)-o.top;l.cursor.style.left=i-l.cursor.offsetWidth/2+"px",l.cursor.style.top=r-l.cursor.offsetHeight/2+"px",l.cursor.style.opacity="1",u.temporaryShakeDisabled=!0,f(),setTimeout((()=>{setTimeout((()=>{y();const e=(e=>{const o=Object.keys(t).filter((t=>t!==e));return o[Math.floor(Math.random()*o.length)]})(a);a=e,d(e),setTimeout((()=>{setTimeout((()=>{R(),u.clickProcessing=!1,u.temporaryShakeDisabled=!1}),1e3)}),s)}),1e3)}),500)},D=e=>{const t=l.picture.getBoundingClientRect(),o=(e.clientX||e.touches?.[0]?.clientX||0)-t.left-l.cursor.offsetWidth/2,s=(e.clientY||e.touches?.[0]?.clientY||0)-t.top-l.cursor.offsetHeight/2;l.cursor.style.left=`${o}px`,l.cursor.style.top=`${s}px`,l.cursor.style.opacity="1"},P=()=>window.innerWidth<=n;l.headerLogo&&l.headerTradeImage?(l.headerLogo.src=t[a].logo,l.headerTradeImage.src=t[a].logo,console.log("Header initialized with logo and trade images.")):console.warn("Header elements (logo or trade image) are missing."),l.picture?(Object.values(t).forEach((e=>{Object.values(e).forEach((e=>{e&&((new Image).src=e)}))})),(()=>{const e=(new Date).toDateString();u.lastResetDate!==e&&(u.shotsRemaining=o,u.lastResetDate=e,g())})(),h(),m(),d(a,!0),P()?l.picture.addEventListener("touchstart",T):(l.picture.addEventListener("mousemove",v),l.picture.addEventListener("mouseleave",k),l.picture.addEventListener("mousemove",D),l.picture.addEventListener("click",T)),l.pictureImage.style.transition=`opacity ${i}ms ease`,l.soundButton.addEventListener("click",S)):console.warn("Element '.picture' not found. Skipping related logic."),window.FLS=!0,document.documentElement.classList.contains("loading")||window.addEventListener("load",(function(){setTimeout((function(){document.documentElement.classList.add("loaded")}),0)}))})();